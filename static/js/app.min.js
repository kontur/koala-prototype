/*!  - v0.0.0 - 2014-12-24
* https://github.com/kontur/koala-prototype
* Copyright (c) 2014 ; Licensed  */
angular.module("Koala.controllers",["geolocation"]).controller("HomeController",["$scope","$location",function(a,b){console.log("hello home controller"),a.go=function(c){b.path(c+"/"+a.term)}}]).controller("HereController",["$scope","$route","geolocation","Venues",function(a,b,c,d){console.log("HereController"),a.loading=!0,a.uriPart="here",c.getLocation().then(function(b){a.locations=d.show({v1:b.coords.latitude,v2:b.coords.longitude},function(){a.loading=!1},function(){a.loading=!1})})}]).controller("HereCategoryController",["$scope","$route","geolocation","Venues",function(a,b,c,d){console.log("HereCategoryController"),a.loading=!0,c.getLocation().then(function(c){a.places=d.show({v1:c.coords.latitude,v2:c.coords.longitude,v3:b.current.params.category},function(){a.loading=!1},function(){a.loading=!1})})}]).controller("SearchController",["$scope","$route","Venues",function(a,b,c){console.log("SearchController"),a.loading=!0,a.uriPart="search/"+b.current.params.term,a.locations=c.search({v1:b.current.params.term},function(){a.loading=!1},function(){a.loading=!1})}]).controller("SearchCategoryController",["$scope","$route","Venues",function(a,b,c){a.loading=!0,a.places=c.search({v1:b.current.params.term,v2:b.current.params.category},function(){a.loading=!1},function(){a.loading=!1})}]).controller("LocationController",["$scope","$route","Venue",function(a,b,c){console.log("LocationController",b.current.params.id),a.loading=!0,a.media=c.images({id:b.current.params.id},function(){a.loading=!1},function(){a.loading=!1})}]),angular.module("Koala.directives",[]).directive("ngEnter",function(){return function(a,b,c){b.bind("keydown keypress",function(b){console.log(b),13===b.which&&(a.$apply(function(){a.$eval(c.ngEnter)}),b.preventDefault())})}}).directive("loading",function(){return{restrict:"E",replace:!0,template:'<div class="loading"><img src="/static/img/ajax-loader.gif" />loading</div>',link:function(a,b){a.$watch("loading",function(a){a||angular.element(b).remove()})}}}),angular.module("Koala",["ngRoute","Koala.controllers","Koala.services","Koala.directives"]).config(["$routeProvider",function(a){a.when("/home",{templateUrl:"static/partials/home.html",controller:"HomeController"}),a.when("/here",{templateUrl:"static/partials/locations.html",controller:"HereController"}),a.when("/here/explore/:category",{templateUrl:"static/partials/category.html",controller:"HereCategoryController"}),a.when("/search/:term",{templateUrl:"static/partials/locations.html",controller:"SearchController"}),a.when("/search/:term/explore/:category",{templateUrl:"static/partials/category.html",controller:"SearchCategoryController"}),a.when("/location/:id",{templateUrl:"static/partials/location.html",controller:"LocationController"}),a.otherwise({redirectTo:"/home"})}]),angular.module("Koala.services",["ngResource"]).factory("Venue",["$resource",function(a){return a("/api/venue/:id",{},{images:{method:"GET",isArray:!0}})}]).factory("Venues",["$resource",function(a){return a("/api/venues/:action/:v1/:v2/:v3",{v1:"@v1",v2:"@v2",v3:"@v3"},{show:{params:{action:"show"},method:"GET",isArray:!0},search:{params:{action:"search"},method:"GET",isArray:!0}})}]);